# README: 逆転可能な都道府県分析スクリプト

このスクリプトは、参議院選挙データ（CSV）から都道府県ごとに1%票差以内で逆転可能だった選挙区を抽出するPythonツールです。

## 🧩 概要

CSV形式の選挙データ（例: TabulaなどでPDFから抽出）を読み込み、以下の処理を実施します：

1. 各都道府県の当落候補者情報の抽出
2. 都道府県ごとの「1%基準票数」の抽出
3. 当落候補者間の票差を計算
4. 票差が「1%基準」未満の都道府県を出力

## 📁 ファイル構成

```
project_root/
├── input/
│   └── tabula-sangiin2010_07_11.csv  # 入力データ（CSV）
├── analyze_votes.py                  # 本スクリプト
└── README.md                         # このファイル
```

## 🔧 前提条件

* Python 3.x
* pandas

```bash
pip install pandas
```

## 🚀 使用方法

```bash
python analyze_votes.py
```

## 📝 スクリプトの処理内容

### ステップ1：CSVの読み込み

```python
df = pd.read_csv("./input/tabula-sangiin2010_07_11.csv", encoding="utf-8", skip_blank_lines=False)
```

### ステップ2：都道府県と1%基準票の抽出

* 行に「（定数...）」が含まれる場合、その行を都道府県の区切りとして扱い、末尾の数字を1%基準として抽出します。

### ステップ3：候補者情報の整形

* 「当」「落」ラベルのある行を抽出し、直前の都道府県情報を付加。
* 投票数を数値型に変換。

### ステップ4：逆転可能な都道府県の抽出

* 各都道府県について：

  * 最下位当選者と最高位落選者を比較
  * その票差が1%未満なら、逆転可能とみなして抽出

### ステップ5：結果出力

* 標準出力に結果を表示
* 必要に応じてCSVに保存する処理も可能（コメントアウト済）

```python
# df_result.to_csv("逆転可能な都道府県一覧.csv", index=False, encoding="utf-8-sig")
```

## 📊 出力例

```
   都道府県 最下位当選者 得票（当選） 最高位落選者 得票（落選） 票差 1%基準
0   ○○県      山田太郎     12458       鈴木花子     12310   148   200
```

## 📌 補足

* CSVファイルのフォーマットによってはカスタマイズが必要です。
* `1%基準`の数値は明示的に記載されている必要があります。

## ©️ 著作権

データ元に従い、本スクリプトの使用は自己責任でお願いします。

---

質問や改善提案があればお気軽にどうぞ！
